class ImageBoxInstance{constructor(e={}){this.galleryName=e.gallery||"default",this.thumbnails=Array.from(document.querySelectorAll(`.imagebox-thumbnail[data-gallery="${this.galleryName}"]`)),this.options=Object.assign({zoom:!0,fullscreen:!0,loop:!0,lazyLoad:!0},e),this.currentIndex=0,this.isZoomed=!1,this.isFullscreen=!1,this.createDOM(),this.bindThumbnails(),this.bindGlobalEvents()}createDOM(){this.container=document.createElement("div"),this.container.classList.add("imagebox"),this.container.innerHTML=`
			<span class="close-btn">&times;</span>
			<span class="fullscreen-btn">\u26F6</span>
			<button class="nav-btn prev-btn">&larr;</button>
			<button class="nav-btn next-btn">&rarr;</button>
			<div class="imagebox-content">
				<div class="imagebox-media-container"></div>
				<div class="caption"></div>
			</div>
			<div class="imagebox-thumbnails"></div>
		`,document.body.appendChild(this.container),this.mediaContainer=this.container.querySelector(".imagebox-media-container"),this.caption=this.container.querySelector(".caption"),this.thumbBar=this.container.querySelector(".imagebox-thumbnails"),this.fullscreenBtn=this.container.querySelector(".fullscreen-btn"),this.container.querySelector(".close-btn").addEventListener("click",()=>this.close()),this.container.querySelector(".prev-btn").addEventListener("click",()=>this.showPrev()),this.container.querySelector(".next-btn").addEventListener("click",()=>this.showNext()),this.options.fullscreen?this.fullscreenBtn.addEventListener("click",()=>this.toggleFullscreen()):this.fullscreenBtn.style.display="none",this.mediaContainer.addEventListener("touchstart",e=>this.startX=e.touches[0].clientX,{passive:!0}),this.mediaContainer.addEventListener("touchend",e=>{const s=e.changedTouches[0].clientX;this.startX-s>50&&this.showNext(),s-this.startX>50&&this.showPrev()},{passive:!0})}bindThumbnails(){this.thumbnails.forEach((e,s)=>{e.addEventListener("click",()=>this.open(s))})}bindGlobalEvents(){document.addEventListener("keydown",e=>{if(this.container.style.display==="block")switch(e.key){case"Escape":this.close();break;case"ArrowLeft":this.showPrev();break;case"ArrowRight":this.showNext();break;case"f":this.toggleFullscreen();break}})}open(e){this.currentIndex=e,this.updateMedia(e),this.renderThumbBar(),this.container.style.display="block",document.body.style.overflow="hidden",setTimeout(()=>this.container.classList.add("show"),10)}close(){this.container.classList.remove("show"),setTimeout(()=>{this.container.style.display="none",document.body.style.overflow="auto"},300)}updateMedia(e){this.currentIndex=e;const s=this.thumbnails[e],i=s.dataset.full||s.src,r=s.dataset.caption||"",n=s.dataset.type||"image";if(this.mediaContainer.innerHTML="",this.caption.textContent=r,n==="image"){const t=document.createElement("img");t.src=i,t.classList.add("imagebox-media"),this.options.zoom&&(t.addEventListener("wheel",a=>this.handleZoom(a)),t.addEventListener("click",()=>this.resetZoom())),this.mediaContainer.appendChild(t)}else if(n==="video"){const t=document.createElement("div");t.classList.add("video-container"),t.innerHTML=`<iframe src="${i}?autoplay=1" frameborder="0" allowfullscreen></iframe>`,this.mediaContainer.appendChild(t)}else if(n==="html5video"){const t=document.createElement("video");t.src=i,t.controls=!0,t.autoplay=this.options.videoAutoplay,t.classList.add("imagebox-media"),this.mediaContainer.appendChild(t)}this.thumbBar.querySelectorAll("img").forEach((t,a)=>{t.classList.toggle("active",a===e)})}renderThumbBar(){this.thumbBar.innerHTML="",this.thumbnails.forEach((e,s)=>{const i=document.createElement("img");i.src=e.src,i.classList.add("imagebox-thumbnail"),s===this.currentIndex&&i.classList.add("active"),i.addEventListener("click",()=>this.updateMedia(s)),this.thumbBar.appendChild(i)})}showPrev(){this.currentIndex=(this.currentIndex-1+this.thumbnails.length)%this.thumbnails.length,this.updateMedia(this.currentIndex)}showNext(){this.currentIndex=(this.currentIndex+1)%this.thumbnails.length,this.updateMedia(this.currentIndex)}handleZoom(e){e.deltaY<0&&!this.isZoomed&&(e.target.classList.add("zoomed"),this.isZoomed=!0)}resetZoom(){const e=this.container.querySelector(".imagebox-media.zoomed");e&&(e.classList.remove("zoomed"),this.isZoomed=!1)}toggleFullscreen(){var e,s,i;this.isFullscreen?((i=document.exitFullscreen)==null||i.call(document),this.isFullscreen=!1):((s=(e=this.container).requestFullscreen)==null||s.call(e).catch(console.error),this.isFullscreen=!0)}}const ImageBox={init:function(o){new ImageBoxInstance(o)}};window.ImageBox=ImageBox;
